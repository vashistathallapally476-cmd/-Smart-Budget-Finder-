<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Comparison - SmartBudget</title>

<style>
*{
    box-sizing:border-box;
    margin:0;
    padding:0;
    font-family:'Poppins',sans-serif;
}

/* BODY */

body{
    background: linear-gradient(135deg,#0f172a,#1e293b,#020617);
    color:white;
}

/* NAVBAR */

.navbar{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:20px 80px;
    background:rgba(255,255,255,0.05);
    backdrop-filter:blur(10px);
    border-bottom:1px solid rgba(255,255,255,0.08);
}

.logo{
    display:flex;
    align-items:center;
    gap:10px;
    font-size:22px;
    font-weight:600;
}

.logo-box{
    background:linear-gradient(135deg,#6366f1,#22c55e);
    padding:10px;
    border-radius:10px;
}

.nav-links{
    list-style:none;
    display:flex;
    gap:25px;
}

.nav-btn{
    background:none;
    border:none;
    color:#cbd5f5;
    font-size:16px;
    padding:8px 18px;
    border-radius:20px;
    cursor:pointer;
    transition:0.3s;
}

.nav-btn:hover{
    background:rgba(255,255,255,0.08);
    color:white;
}

.active{
    background:linear-gradient(135deg,#6366f1,#22c55e);
    color:white;
}

/* PAGE HEADER */

.page-header{
    padding:50px 80px 20px;
}

.page-header h1{
    font-size:40px;
    margin-bottom:8px;
}

.page-header p{
    color:#cbd5f5;
}

/* EMPTY STATE */

.empty-state{
    text-align:center;
    margin-top:120px;
}

.empty-box{
    background:rgba(255,255,255,0.08);
    width:90px;
    height:90px;
    margin:0 auto 20px;
    border-radius:20px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:32px;
}

.empty-state h2{
    margin-bottom:10px;
}

.empty-state p{
    color:#cbd5f5;
    margin-bottom:25px;
}

.empty-state button{
    padding:12px 26px;
    border:none;
    border-radius:30px;
    background:linear-gradient(135deg,#6366f1,#22c55e);
    color:white;
    font-weight:600;
    cursor:pointer;
    transition:0.3s;
}

.empty-state button:hover{
    transform:translateY(-2px);
}

/* COMPARE CONTAINER */

.compare-container{
    padding:40px 80px;
}

/* TABLE */

.compare-table{
    width:100%;
    border-collapse:collapse;
    background:rgba(255,255,255,0.05);
    backdrop-filter:blur(10px);
    border-radius:15px;
    overflow:hidden;
    border:1px solid rgba(255,255,255,0.08);
}

/* TABLE CELLS */

.compare-table th,
.compare-table td{
    padding:18px;
    text-align:center;
    border-bottom:1px solid rgba(255,255,255,0.08);
}

.compare-table th{
    background:rgba(255,255,255,0.06);
    font-weight:600;
}

/* PRODUCT NAME */

.product-name{
    font-weight:600;
}

/* PRICE */

.price{
    color:#22c55e;
    font-weight:bold;
}

/* BEST SCORE */

.best{
    background:rgba(34,197,94,0.15);
    color:#22c55e;
    font-weight:600;
}

/* REMOVE BUTTON */

.compare-table button{
    margin-top:8px;
    border:none;
    background:none;
    cursor:pointer;
    font-size:16px;
}

/* CLEAR BUTTON */

.compare-container button{
    padding:10px 18px;
    border:none;
    border-radius:25px;
    background:linear-gradient(135deg,#ef4444,#f97316);
    color:white;
    font-weight:600;
    cursor:pointer;
    transition:0.3s;
}

.compare-container button:hover{
    transform:translateY(-2px);
}
</style>
</head>

<body>

  <nav class="navbar">
        <div class="logo">
            <div class="logo-box">üí≥</div>
            <span>SmartBudget</span>
        </div>
        <ul class="nav-links">
            <li>
            <button class="nav-btn"data-page="index.html" onclick="goToHome()">Home</button>
            </li>
            <li>
            <button class="nav-btn"data-page="budget.html" onclick="goToBudget()">Budget</button>
            </li>
            <li>
            <button class="nav-btn" data-page="recommendations.html"onclick="goToRecommendations()">Recommendations</button>
            </li>
            <li>
            <button class="nav-btn"data-page="comparison.html"  onclick="goToComparison()">Comparison</button>
            </li>
            <li>
             <button class="nav-btn" data-page="wishlist.html" onclick="goToWishlist()">
                    Wishlist ‚ù§Ô∏è <span id="wishlistCount">(0)</span>
            </button>
            </li>
            <li>
            <button class="nav-btn" data-page="about.html"  onclick="goToAbout()">About</button>
            </li>
        </ul>
    </nav>

<div class="page-header">
    <h1>Compare Products</h1>
    <p>Select 2‚Äì3 products from Recommendations to compare</p>
</div>

<!-- ===== EMPTY STATE (SHOW WHEN NO PRODUCTS) ===== -->
<div class="empty-state" id="emptyState">
    <div class="empty-box">‚áÑ</div>
    <h2>No Products to Compare</h2>
    <p>Add 2‚Äì3 products from the Recommendations page to compare them side by side.</p>
    <button onclick="location.href='recommendations.html'">Browse Recommendations</button>
</div>

<!-- ===== COMPARISON TABLE (HIDDEN BY DEFAULT) ===== -->
<div class="compare-container">

    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
        <h2>Comparison Table</h2>
        <button onclick="clearAll()"
            style="background:#ff4d4d;color:white;border:none;padding:8px 15px;border-radius:6px;cursor:pointer;">
            Clear All
        </button>
    </div>

    <div id="comparisonTableWrapper" style="display:none;">
        <table id="comparisonTable" class="compare-table"></table>
    </div>

</div>




<script>


function goToHome(){
    window.location.href = "index.html";
}
function goToBudget(){
    window.location.href = "budget.html";
}
function goToRecommendations(){
    window.location.href = "recommendations.html";
}
function goToComparison(){
    window.location.href = "comparison.html";
}
function goToWishlist(){
    window.location.href = "wishlist.html";
}
function goToAbout(){
    window.location.href = "about.html";
}
  function go(page){
    window.location.href = page;
}

// highlight current page
const currentURL = window.location.href;

document.querySelectorAll(".nav-btn").forEach(btn => {
    const page = btn.dataset.page;
    if(currentURL.includes(page)){
        btn.classList.add("active");
    }
});
//update wishlist count
function updateWishlistCount(){

    let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];
    const countElement = document.getElementById("wishlistCount");

    if(countElement){
        countElement.innerText = "(" + wishlist.length + ")";
    }
}

//compare both the products selected

document.addEventListener("DOMContentLoaded", function(){

    const table = document.getElementById("comparisonTable");
    const wrapper = document.getElementById("comparisonTableWrapper");
    const emptyState = document.getElementById("emptyState");

    let comparison = JSON.parse(localStorage.getItem("comparison")) || [];

    if(comparison.length === 0){
        emptyState.style.display = "block";
        wrapper.style.display = "none";
        return;
    }

    emptyState.style.display = "none";
    wrapper.style.display = "block";

    // Extract numeric values safely
    const prices = comparison.map(p =>
        parseInt(p.price.replace(/[^0-9]/g, "")) || 0
    );

    const ratings = comparison.map(p =>
        parseFloat(p.rating) || 0
    );

    const reviews = comparison.map(p =>
        parseInt(p.reviewsCount) || 0
    );

    const maxPrice = Math.max(...prices);
    const minPrice = Math.min(...prices);
    const maxReviews = Math.max(...reviews);

    let finalScores = [];

    comparison.forEach((item, i)=>{

        // 1Ô∏è‚É£ Rating Score
        const ratingScore = ratings[i] / 5;

        // 2Ô∏è‚É£ Review Score (log normalized)
        const reviewScore = maxReviews > 0
            ? Math.log10(reviews[i] + 1) / Math.log10(maxReviews + 1)
            : 0;

        // 3Ô∏è‚É£ Price Score (reverse normalized)
        const priceScore = (maxPrice !== minPrice)
            ? (maxPrice - prices[i]) / (maxPrice - minPrice)
            : 1;

        // Final Score
        const final =
            (0.4 * ratingScore) +
            (0.3 * reviewScore) +
            (0.3 * priceScore);

        finalScores.push(final);
    });

    const maxFinalScore = Math.max(...finalScores);

    // ===== BUILD TABLE =====

    let headerRow = "<tr><th>Feature</th>";
    comparison.forEach((item, index)=>{
        headerRow += `
            <th>
                ${item.name}
                <button onclick="removeItem(${index})"
                    style="margin-top:10px;border:none;background:none;cursor:pointer;">
                         ‚ùå
                </button>
            </th>
        `;
    });
    headerRow += "</tr>";

    // Image Row
    let imageRow = "<tr><td><strong>Image</strong></td>";
    comparison.forEach(item=>{
        imageRow += `<td>${item.image}</td>`;
    });
    imageRow += "</tr>";

    // Rating Row
    let ratingRow = "<tr><td><strong>Rating</strong></td>";
    ratings.forEach(r=>{
        ratingRow += `<td>${r}</td>`;
    });
    ratingRow += "</tr>";

    // Reviews Row
    let reviewRow = "<tr><td><strong>Reviews</strong></td>";
    reviews.forEach(r=>{
        reviewRow += `<td>${r}</td>`;
    });
    reviewRow += "</tr>";

    // Price Row
    let priceRow = "<tr><td><strong>Price</strong></td>";
    prices.forEach((p,i)=>{
        priceRow += `<td>‚Çπ${p}</td>`;
    });
    priceRow += "</tr>";

    // Final Score Row (Highlight Best)
    let finalRow = "<tr><td><strong>Final Score</strong></td>";
    finalScores.forEach((score,i)=>{
        const isBest = score === maxFinalScore;
        finalRow += `
            <td style="${isBest ? "background:#e6f7ff;font-weight:bold;" : ""}">
                ${score.toFixed(3)}
                ${isBest ? "<br>üèÜ Best Overall" : ""}
            </td>
        `;
    });
    finalRow += "</tr>";

    table.innerHTML =
        headerRow +
        imageRow +
        ratingRow +
        reviewRow +
        priceRow +
        finalRow;

});

function removeItem(index){
    let comparison = JSON.parse(localStorage.getItem("comparison")) || [];
    comparison.splice(index,1);
    localStorage.setItem("comparison", JSON.stringify(comparison));
    location.reload();
}

function clearAll(){
    localStorage.removeItem("comparison");
    location.reload();
}



</script>

</body>
</html>
